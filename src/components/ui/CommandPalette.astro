---
/**
 * CommandPalette.astro - Astro wrapper dla React Command Palette
 * 
 * Funkcje:
 * - Integracja React island z Astro
 * - Client-side hydration
 * - i18n integration
 * - Global keyboard shortcuts
 */

import CommandPaletteWrapper from './CommandPaletteWrapper.tsx';
import { resolveLocale } from '../../i18n/config';

// Pobierz aktualny jÄ™zyk z URL
const currentPath = Astro.url.pathname;
const locale = resolveLocale(currentPath.split('/')[1]);
---

<!-- Command Palette React Island -->
<CommandPaletteWrapper client:only="react" locale={locale} />

<script>
  // Global keyboard shortcut handler
  function initCommandPalette() {
    const handleKeyDown = (e: KeyboardEvent) => {
      // Cmd/Ctrl + K
      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
        e.preventDefault();
        
        // Dispatch custom event to open Command Palette
        const event = new CustomEvent('openCommandPalette', {
          detail: { source: 'keyboard' }
        });
        document.dispatchEvent(event);
      }
    };

    document.addEventListener('keydown', handleKeyDown);
    
    // Cleanup
    return () => {
      document.removeEventListener('keydown', handleKeyDown);
    };
  }

  // Initialize on DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCommandPalette);
  } else {
    initCommandPalette();
  }
</script>
